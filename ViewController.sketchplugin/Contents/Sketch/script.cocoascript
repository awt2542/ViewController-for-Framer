// TODO: Add support for backButton

var onRun = function(context) {
  	function createSelect(msg, items, selectedItemIndex){
      selectedItemIndex = selectedItemIndex || 0

      var accessory = NSComboBox.alloc().initWithFrame(NSMakeRect(0,0,200,25))
      accessory.addItemsWithObjectValues(items)
      accessory.selectItemAtIndex(selectedItemIndex)

      var button = context.selection[0];
      var view = context.selection[1];
      var alert = NSAlert.alloc().init()
      alert.setMessageText(msg)
      alert.setInformativeText('From "'+button.name()+'" to "'+view.name()+'"')
      
      alert.addButtonWithTitle('Create link') // 1000
      alert.addButtonWithTitle('Cancel') // 1001
      alert.setAccessoryView(accessory)

      var responseCode = alert.runModal()
      var sel = accessory.indexOfSelectedItem()

      if (responseCode == 1000){
        return sel
      }
      
    }

  if (context.selection.count() == 2){
    var options = ['Switch instant âš¡ï¸','Fade in ğŸ‘»','Zoom in  ğŸ‘€','Slide in up ğŸ‘†','Slide in right ğŸ‘ˆ','Slide in down ğŸ‘‡','Slide in left ğŸ‘‰','Slide out up ğŸ‘†','Slide out right ğŸ‘‰','Slide out down ğŸ‘‡','Slide out left ğŸ‘ˆ']
    var keywords = ['switchInstant','fadeIn','zoomIn','slideInUp','slideInRight','slideInDown','slideInLeft','slideOutUp','slideOutRight','slideOutDown','slideOutLeft']
    var choice = createSelect('Choose a transition',options, 1)
    var button = context.selection[0];
    var view = context.selection[1];
    if (choice){
      button.setName(keywords[choice]+"_"+view.name());
    }
  } else {
    context.document.showMessage("Select exactly 2 layers before creating a link")
  }
};
