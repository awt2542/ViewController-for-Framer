// TODO: Add support for backButton

var onRun = function(context) {
    
    function createSelect(first,second,selectIndex){
      var options = ['Switch instant âš¡ï¸','Fade in ğŸ‘»','Zoom in  ğŸ‘€','Slide in up ğŸ‘†','Slide in right ğŸ‘ˆ','Slide in down ğŸ‘‡','Slide in left ğŸ‘‰','Slide out up ğŸ‘†','Slide out right ğŸ‘‰','Slide out down ğŸ‘‡','Slide out left ğŸ‘ˆ']
      var keywords = ['switchInstant','fadeIn','zoomIn','slideInUp','slideInRight','slideInDown','slideInLeft','slideOutUp','slideOutRight','slideOutDown','slideOutLeft']
      var accessory = NSComboBox.alloc().initWithFrame(NSMakeRect(0,0,200,25))
      accessory.addItemsWithObjectValues(options)
      accessory.selectItemAtIndex(selectIndex) // pre-select first item
      
      var button = first
      var view = second
      
      var alert = NSAlert.alloc().init()
      alert.setMessageText('Choose a transition')
      alert.setInformativeText('"'+button.name()+'" to "'+view.name()+'"')
      
      alert.addButtonWithTitle('Create link') // 1000
      alert.addButtonWithTitle('Cancel') // 1001
      alert.addButtonWithTitle('Reverse â†”') // 1002
      alert.setAccessoryView(accessory)

      var responseCode = alert.runModal()
      var sel = accessory.indexOfSelectedItem()

      if (responseCode == 1000){
        button.setName(keywords[sel]+"_"+view.name());
      } else if (responseCode == 1002) {
        createSelect(second,first,sel)
      }
      
    }

  if (context.selection.count() == 2){
    createSelect(context.selection[0],context.selection[1], 0)
  } else {
    context.document.showMessage("Select exactly 2 layers before creating a link")
  }
};
